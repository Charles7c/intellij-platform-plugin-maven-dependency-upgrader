package top.charles7c.mavendependencyupgrader.model

/**
 * Maven 依赖漏洞信息
 */
data class VulnerabilityInfo(
    /** 漏洞 ID（如 CVE-2024-xxxx） */
    val id: String,
    /** 漏洞标题 */
    val title: String,
    /** 漏洞描述 */
    val description: String,
    /** 严重程度 */
    val severity: Severity,
    /** CVSS 评分 */
    val cvssScore: Float = 0f,
    /** 外部参考链接 */
    val reference: String = ""
) {
    enum class Severity(val label: String, val priority: Int) {
        CRITICAL("严重", 4),
        HIGH("高危", 3),
        MEDIUM("中危", 2),
        LOW("低危", 1),
        UNKNOWN("未知", 0);

        companion object {
            fun fromCvssScore(score: Float): Severity = when {
                score >= 9.0f -> CRITICAL
                score >= 7.0f -> HIGH
                score >= 4.0f -> MEDIUM
                score > 0f -> LOW
                else -> UNKNOWN
            }
        }
    }
}
